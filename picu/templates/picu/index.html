<!-- index page shows a searchable form and a link to anter a new admission via a number of routes-->
{% extends "admin/change_list.html" %}
{% load i18n admin_urls static admin_list admin_modify %}

{% block bodyclass %}{{ block.super }} app-picu change-list {% endblock %}

{% block breadcrumbs %} <div class="breadcrumbs">&nbsp;</div> {% endblock %}

{% block content %}
	<div id="content-main" style="width=100%;">
		{% block object-tools %}
            <ul class="object-tools">
                <li>
                  <a href="{% url 'admin:picu_admission_add' %}" class="addlink">New Admission</a>
                </li>
            </ul>
        {% endblock %}
        <div id="searchform" class="module filtered">
            <div class="actions">
                <form id="search-patient-form" action="{% url 'picu:patient_search' %}" method="post">
                    <div>
                        {% csrf_token %}
                        <table>
                            {{form}}
                        </table>
                         <input type="submit" value="Search">
                        {% prepopulated_fields_js %}
                    </div>
                </form>
            </div>

            <div class="clear"><br/><hr/></div>

            {% if patient_list %}

            <div id="changelist" class="results">
                <table>
                    <caption>
                        <a href="#" class="section" title="patients">Patients matched</a>
                    </caption>
                    <thead>
                        <tr>
                            <th scope="col" class="action-checkbox-column">
                               <div class="text">
                                   <span>
                                       <input id="action-toggle" type="checkbox">
                                   </span>
                               </div>
                               <div class="clear"></div>
                            </th>
                            <th scope="col" class="sortable column-first_name">
                               <div class="text">
                                    <a href="?o=1">First name</a>
                               </div>
                               <div class="clear"></div>
                            </th>
                            <th scope="col" class="sortable column-second_name">
                               <div class="text">
                                    <a href="?o=2">Second name</a>
                               </div>
                               <div class="clear"></div>
                            </th>
                            <th scope="col" class="sortable column-gender">
                               <div class="text">
                                    <a href="?o=3">Gender</a>
                               </div>
                               <div class="clear"></div>
                            </th>
                            <th scope="col" class="sortable column-date_of_birth">
                               <div class="text">
                                    <a href="?o=4">Date of Birth</a>
                               </div>
                               <div class="clear"></div>
                            </th>
                            <th scope="col" class="sortable column-hiv">
                               <div class="text">
                                    <a href="?o=5">Hiv</a>
                               </div>
                               <div class="clear"></div>
                            </th>
                            <th scope="col" class="sortable column-age_in_months">
                               <div class="text">
                                    <a href="?o=6">Age in Months</a>
                               </div>
                               <div class="clear"></div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for patient in patient_list %}
                            <tr class="{% cycle 'row1' 'row2' %}">
                                <td class="action-checkbox">
                                    <input class="action-select" name="_selected_action" value="1" type="checkbox">
                                </td>
                                <th class="field-first_name">
                                    <!-- link to view the patient details + all admissions-->
                                    <a href="#">{{ patient.first_name }}</a>
                                </th>
                                <td class="field-second_name">{{ patient.second_name }}</td>
                                <td class="field-gender">{{ patient.gender }}</td>
                                <td class="field-date_of_birth nowrap">{{ patient.date_of_birth }}</td>
                                <td class="field-hiv">
                                    <img src="/static/admin/img/icon-{% if patient.hiv %}yes.svg {% else %}no.svg {% endif %}" alt="True">
                                </td>
                                <td class="field-age_in_months">{{ patient.age_in_months }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        {% else %}
            <p>
                {% trans "No patients available" %}
                <!-- to do provide a button to add addmission-->
            </p>
        {% endif %}
             </div>
    </div>
{% endblock %}